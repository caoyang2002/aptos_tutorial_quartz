

# ECC加密算法

## Elliptic Curve Cryptography

椭圆曲线离散对数问题

（Elliptic Curve Discrete Logarithm Problem，ECDLP）

椭圆曲线上的两个点 $P$ 和 $Q$，$k$ 为整数。

$$Q = kP$$

椭圆曲线加密的数学原理：

点 $P$ 称为基点（base point）；$k$ 为私钥（private key）；$Q$ 为公钥（public key）

给定 $k$ 和 $P$，根据加法法则，计算 $Q$ 很容易。

但给定 $P$ 和 $Q$，求 $k$ ⾮常困难（实际应⽤ECC，质数 $p$ 取的⾮常⼤，穷举出 $k$ ⾮常困难）。



 椭圆曲线

$$y2 = x3+ax+b$$

$$(4a3+27b2 ≠ 0)$$

椭圆曲线的加法：

 
![[椭圆曲线-过AB的直线.png]]

特殊情况：

1. 无穷原点

![[椭圆曲线-无穷原点.png]]

2. 加它自己（椭圆曲线的乘法）
$$A + A = 2A$$

![[椭圆曲线-曲线在点A上的切线.png]]

 3. $3A$ 的计算

![[椭圆曲线-3A的计算.png]]


![[椭圆曲线-有限域.png]]

![[椭圆曲线-各个阶的结果.png]]

# 加密过程



$$Q = kP$$

椭圆曲线公式：$$y^2=x^3+ax+b$$ 

1、选⼀条椭圆曲线 $Ep(a,b)$, 并取椭圆曲线上⼀点作为基点 $P$。

2、选定⼀个⼤数 $k$ 作为私钥，并⽣成公钥 $Q=kP$。

3、加密：选择随机数 $r$，将消息 $M$ ⽣成密⽂ $C$。密⽂是⼀个点对，即 $C=(rP, M+rQ)$。

4、解密：$M+rQ-k(rP) = M+r(kP)-k(rp) = M$，除了 $k$ 是保密的外，其他的都是公开的 

---

# 加密原理

椭圆曲线是连续的，并不适合加密。

我们要把椭圆曲线变成离散的点。

>[!NOTE]
>把椭圆曲线定义在 **有限域** 上！

## 域

**域**是⼀个可以在其上进⾏加法、减法、乘法、和除法运算，⽽结果不会超出域的集合。

如：有理数集合、实数集合、复数集合都是域，但整数集合不是。

（很明显，使⽤除法得到的分数或者⼩数已超出整数集合）。




## 有限域

如果域 $F$ 只包含 **有限个元素**，则称其为 **有限域**。

有限域中元素的 **个数** 称为有限域的 **阶**。

每个有限域的阶必为素数的幂，即有限域的阶可表示为 $p^n$ ( $p$ 是素数，$n$ 是正整数)，

该有限域通常称为 Galois 域(Galois Fields)，记为 $GF(p^n)$。

## 有限域上的椭圆曲线

在域的定义基础上，作如下修改：

1. 定义**模 $p$ 加法** 和 **模 $p$ 乘法**（加或乘的结果超过 $p$ 时，模 $p$ 取余数，$p$ 为素数）。

2. 集合内的元素经过加法和乘法计算，**结果仍然在集合内**。

3. 计算符合 **交换律**、**结合律**、**分配律**。

4. 加法和乘法有 **单位元素**（所有的集合内的值都有对应的负数，所有集合内⾮零值都有倒数）。


 
 

## 有限域上的椭圆曲线运算

椭圆曲线：$$y2 = x3+x+1$$

有限域：$$GF(23)$$

有限域上的椭圆曲线：
$$y^2 \equiv x^3 + x + 1 \pmod{23}$$
 
有限域上的椭圆曲线运算

![[椭圆曲线-有限域-2.png]]

有限域上的椭圆曲线运算：

![[椭圆曲线-过AB的直线.png]]

![[椭圆曲线-无穷原点.png]]



$$x_3 \equiv k^2 - x_1 - x_2\pmod p$$

$$y_3 \equiv k(x_1 - x_3)-y_1 \pmod p$$

$$\text 若 P=Q, \text 则 k = \frac{3x_1^2+a}{2y_1}\pmod p $$

$$\text 若 P \neq Q, \text 则 k = \frac{y_2 - y_1}{x_2-x_1}\pmod p $$

![[椭圆曲线-曲线在点A上的切线.png]]

$$y^2 \equiv x^3 + x + 1 \pmod{23}$$

基点：$A (0,1)$

$$y2 = x3+ax+b$$

## 有限域上的椭圆曲线运算

先 做 倍 数 再 做 加 法 。 假 设 $n=151$， 其 对 应 的 ⼆ 进 制 是 $10010111$ 。⽽⼆进制数字可以转化为：

 $$151 = 1 \times 2^7 + 0 \times 2^6 + 0 \times 2^5 + 1 \times 2^4 + 0 \times 2^3 + 1 \times 2^2 + 1 \times 2^1 + 1 \times 2^0$$


![[椭圆曲线-有限域.png]]

$$151P = 2^7P $$
 

   

 

 




[1] 刘启林. ECC椭圆曲线密码学的原理、公式推导、例⼦、Python实现和应⽤[DB/OL].https://

zhuanlan.zhihu.com/p/42629724. 知乎. 2020-12-13.

[2] 李_MAX. ECC椭圆曲线加密算法[DB/OL]. https://www.jianshu.com/p/e41bc1eb1d81. 简书.

2020-08-14.

[3]James Early. Elliptic Curve Cryptography & Diffie-Hellman[DB/OL]. https://

www.youtube.com/watch?v=yDXiDOJgxmg. Youtube. ⽇期不详.

[4] 已不再更新. ECC椭圆曲线加密算法(⼆)[DB/OL]. https://www.jianshu.com/p/8fbd8cd84e1e. 简书.

2018-12-19.

[5] 李浪，邹袆，郭迎．密码⼯程学[M]：清华⼤学出版社，2014.12

[6] 百度百科. 有限域词条[DB/OL]. https://baike.baidu.com/item/%E6%9C%89%E9%99%90%E5%9F%9F/

4273049?fr=aladdin. 2018-07-18.

[7] 继舜. 有限域计算概述[DB/OL]. https://zhuanlan.zhihu.com/p/262267121. 知乎. 2020-10-08.

[8] SlteBus. ECC椭圆曲线加解密原理详解. [DB/OL], https://blog.csdn.net/sitebus/article/details/

82835492.CSDN. 2018-09-26.

[9] Avery. ECC椭圆曲线加密算法：介绍[DB/OL]. https://zhuanlan.zhihu.com/p/36326221. 知乎.

2018-5-08.

